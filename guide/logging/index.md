[{"bookPath":"guide","title":"How do I add tracing logs to my Reach program?","titleId":"guide-logging","hasOtp":true,"hasPageHeader":true},"<p>\n  <i id=\"p_0\" class=\"pid\"></i>Sometimes it is useful to add \"tracing logs\" to your program so you can see the values of variables and computations as the program is running.\n  For example, if we were writing purely in JavaScript, we might write<a href=\"#p_0\" class=\"pid\">0</a>\n</p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"function fib(n) {\n  console.log(`Starting to compute Fibonacci`);\n  let i = 1;\n  let [a, b] = [0, 1];\n  while ( i++ < n ) {\n    console.log(i, a, b);\n    [a, b] = [b, a + b];\n  }\n  return a;\n}\nfib(9);\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><span style=\"color: #D73A49\">function</span><span style=\"color: #24292E\"> </span><span style=\"color: #6F42C1\">fib</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">n</span><span style=\"color: #24292E\">) {</span></li><li value=\"2\"><span style=\"color: #24292E\">  console.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">(</span><span style=\"color: #032F62\">`Starting to compute Fibonacci`</span><span style=\"color: #24292E\">);</span></li><li value=\"3\"><span style=\"color: #24292E\">  </span><span style=\"color: #D73A49\">let</span><span style=\"color: #24292E\"> i </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">;</span></li><li value=\"4\"><span style=\"color: #24292E\">  </span><span style=\"color: #D73A49\">let</span><span style=\"color: #24292E\"> [a, b] </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> [</span><span style=\"color: #005CC5\">0</span><span style=\"color: #24292E\">, </span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">];</span></li><li value=\"5\"><span style=\"color: #24292E\">  </span><span style=\"color: #D73A49\">while</span><span style=\"color: #24292E\"> ( i</span><span style=\"color: #D73A49\">++</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">&lt;</span><span style=\"color: #24292E\"> n ) {</span></li><li value=\"6\"><span style=\"color: #24292E\">    console.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">(i, a, b);</span></li><li value=\"7\"><span style=\"color: #24292E\">    [a, b] </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> [b, a </span><span style=\"color: #D73A49\">+</span><span style=\"color: #24292E\"> b];</span></li><li value=\"8\"><span style=\"color: #24292E\">  }</span></li><li value=\"9\"><span style=\"color: #24292E\">  </span><span style=\"color: #D73A49\">return</span><span style=\"color: #24292E\"> a;</span></li><li value=\"10\"><span style=\"color: #24292E\">}</span></li><li value=\"11\"><span style=\"color: #6F42C1\">fib</span><span style=\"color: #24292E\">(</span><span style=\"color: #005CC5\">9</span><span style=\"color: #24292E\">);</span></li></ol></pre>\n<p><i id=\"p_1\" class=\"pid\"></i>And we'd see the output<a href=\"#p_1\" class=\"pid\">1</a></p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"Starting to compute Fibonacci\n2 0 1\n3 1 1\n4 1 2\n5 2 3\n6 3 5\n7 5 8\n8 8 13\n9 13 21\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\">Starting to compute Fibonacci</li><li value=\"2\">2 0 1</li><li value=\"3\">3 1 1</li><li value=\"4\">4 1 2</li><li value=\"5\">5 2 3</li><li value=\"6\">6 3 5</li><li value=\"7\">7 5 8</li><li value=\"8\">8 8 13</li><li value=\"9\">9 13 21</li></ol></pre>\n<p><i id=\"p_2\" class=\"pid\"></i>How can we do something like this in Reach?<a href=\"#p_2\" class=\"pid\">2</a></p>\n<p>\n  <i id=\"p_3\" class=\"pid\"></i>The key is to use participant interact interfaces to share arbitrary information with the frontend,\n  which has the ability to log to a console or any other tracing service.\n  For example:<a href=\"#p_3\" class=\"pid\">3</a>\n</p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"export const main = Reach.App(() => {\n  const A = Participant('Alice', {\n    logBool: Fun([UBool], Null),\n    logNumber: Fun([UInt], Null),\n  });\n  init();\n  A.only(() => {\n    interact.logBool(true);\n    interact.logNumber(1); });\n  exit();\n});\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/module/#rsh_export\" title=\"rsh: export\"><span style=\"color: #D73A49\">export</span></a><span style=\"color: #24292E\"> </span><a href=\"/rsh/compute/#rsh_const\" title=\"rsh: const\"><span style=\"color: #D73A49\">const</span></a><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">main</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> Reach.</span><a href=\"/rsh/module/#rsh_App\" title=\"rsh: App\"><span style=\"color: #6F42C1\">App</span></a><span style=\"color: #24292E\">(() </span><a href=\"/rsh/compute/#rsh_=%3E\" title=\"rsh: =>\"><span style=\"color: #D73A49\">=&gt;</span></a><span style=\"color: #24292E\"> {</span></li><li value=\"2\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/compute/#rsh_const\" title=\"rsh: const\"><span style=\"color: #D73A49\">const</span></a><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><a href=\"/rsh/appinit/#rsh_Participant\" title=\"rsh: Participant\"><span style=\"color: #6F42C1\">Participant</span></a><span style=\"color: #24292E\">(</span><span style=\"color: #032F62\">'Alice'</span><span style=\"color: #24292E\">, {</span></li><li value=\"3\"><span style=\"color: #24292E\">    logBool: </span><a href=\"/rsh/compute/#rsh_Fun\" title=\"rsh: Fun\"><span style=\"color: #6F42C1\">Fun</span></a><span style=\"color: #24292E\">([UBool], Null),</span></li><li value=\"4\"><span style=\"color: #24292E\">    logNumber: </span><a href=\"/rsh/compute/#rsh_Fun\" title=\"rsh: Fun\"><span style=\"color: #6F42C1\">Fun</span></a><span style=\"color: #24292E\">([UInt], Null),</span></li><li value=\"5\"><span style=\"color: #24292E\">  });</span></li><li value=\"6\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/appinit/#rsh_init\" title=\"rsh: init\"><span style=\"color: #6F42C1\">init</span></a><span style=\"color: #24292E\">();</span></li><li value=\"7\"><span style=\"color: #24292E\">  </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\">.</span><a href=\"/rsh/step/#rsh_only\" title=\"rsh: only\"><span style=\"color: #6F42C1\">only</span></a><span style=\"color: #24292E\">(() </span><a href=\"/rsh/compute/#rsh_=%3E\" title=\"rsh: =>\"><span style=\"color: #D73A49\">=&gt;</span></a><span style=\"color: #24292E\"> {</span></li><li value=\"8\"><span style=\"color: #24292E\">    interact.</span><span style=\"color: #6F42C1\">logBool</span><span style=\"color: #24292E\">(</span><a href=\"/rsh/compute/#rsh_true\" title=\"rsh: true\"><span style=\"color: #005CC5\">true</span></a><span style=\"color: #24292E\">);</span></li><li value=\"9\"><span style=\"color: #24292E\">    interact.</span><span style=\"color: #6F42C1\">logNumber</span><span style=\"color: #24292E\">(</span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">); });</span></li><li value=\"10\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/step/#rsh_exit\" title=\"rsh: exit\"><span style=\"color: #6F42C1\">exit</span></a><span style=\"color: #24292E\">();</span></li><li value=\"11\"><span style=\"color: #24292E\">});</span></li></ol></pre>\n<p>\n  <i id=\"p_4\" class=\"pid\"></i>However, as this example shows, it can be inconvenient to use this pattern, because <span class=\"snip\"><a href=\"/rsh/compute/#rsh_Fun\" title=\"rsh: Fun\"><span style=\"color: #24292E\">Fun</span></a></span> types constrain their domains to particular input data types, but we may need to log different kinds of data at different points in the program.\n  Similarly, it is inconvenient to use an entire <span class=\"snip\"><a href=\"/rsh/step/#rsh_only\" title=\"rsh: only\"><span style=\"color: #24292E\">only</span></a></span> block for a simple log.<a href=\"#p_4\" class=\"pid\">4</a>\n</p>\n<p>\n  <i id=\"p_5\" class=\"pid\"></i>Reach provides two conveniences for this situation that taste great together: unconstrained domain function types and interact shorthand.\n  The first allows a function in a participant interact interface to have a completely unconstrained domain.\n  The second allows a call to a frontend from anywhere without an <span class=\"snip\"><a href=\"/rsh/step/#rsh_only\" title=\"rsh: only\"><span style=\"color: #24292E\">only</span></a></span>, provided the function returns no value.\n  If we re-write the above example using both of these patterns, it looks like:<a href=\"#p_5\" class=\"pid\">5</a>\n</p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"export const main = Reach.App(() => {\n  const A = Participant('Alice', {\n    log: Fun(true, Null),\n  });\n  init();\n  A.interact.log(true);\n  A.interact.log(1);\n  // We can easily add more complex log entries as well.\n  A.interact.log([1, true]);\n  A.interact.log({x: 1, y: true});\n  const x = 1;\n  const y = true;\n  A.interact.log({x, y});\n  A.interact.log(Maybe(UInt).Some(5));\n  exit();\n});\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/module/#rsh_export\" title=\"rsh: export\"><span style=\"color: #D73A49\">export</span></a><span style=\"color: #24292E\"> </span><a href=\"/rsh/compute/#rsh_const\" title=\"rsh: const\"><span style=\"color: #D73A49\">const</span></a><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">main</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> Reach.</span><a href=\"/rsh/module/#rsh_App\" title=\"rsh: App\"><span style=\"color: #6F42C1\">App</span></a><span style=\"color: #24292E\">(() </span><a href=\"/rsh/compute/#rsh_=%3E\" title=\"rsh: =>\"><span style=\"color: #D73A49\">=&gt;</span></a><span style=\"color: #24292E\"> {</span></li><li value=\"2\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/compute/#rsh_const\" title=\"rsh: const\"><span style=\"color: #D73A49\">const</span></a><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><a href=\"/rsh/appinit/#rsh_Participant\" title=\"rsh: Participant\"><span style=\"color: #6F42C1\">Participant</span></a><span style=\"color: #24292E\">(</span><span style=\"color: #032F62\">'Alice'</span><span style=\"color: #24292E\">, {</span></li><li value=\"3\"><span style=\"color: #24292E\">    log: </span><a href=\"/rsh/compute/#rsh_Fun\" title=\"rsh: Fun\"><span style=\"color: #6F42C1\">Fun</span></a><span style=\"color: #24292E\">(</span><a href=\"/rsh/compute/#rsh_true\" title=\"rsh: true\"><span style=\"color: #005CC5\">true</span></a><span style=\"color: #24292E\">, Null),</span></li><li value=\"4\"><span style=\"color: #24292E\">  });</span></li><li value=\"5\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/appinit/#rsh_init\" title=\"rsh: init\"><span style=\"color: #6F42C1\">init</span></a><span style=\"color: #24292E\">();</span></li><li value=\"6\"><span style=\"color: #24292E\">  </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\">.interact.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">(</span><a href=\"/rsh/compute/#rsh_true\" title=\"rsh: true\"><span style=\"color: #005CC5\">true</span></a><span style=\"color: #24292E\">);</span></li><li value=\"7\"><span style=\"color: #24292E\">  </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\">.interact.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">(</span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">);</span></li><li value=\"8\"><span style=\"color: #24292E\">  </span><span style=\"color: #6A737D\">// We can easily add more complex log entries as well.</span></li><li value=\"9\"><span style=\"color: #24292E\">  </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\">.interact.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">([</span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">, </span><a href=\"/rsh/compute/#rsh_true\" title=\"rsh: true\"><span style=\"color: #005CC5\">true</span></a><span style=\"color: #24292E\">]);</span></li><li value=\"10\"><span style=\"color: #24292E\">  </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\">.interact.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">({x: </span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">, y: </span><a href=\"/rsh/compute/#rsh_true\" title=\"rsh: true\"><span style=\"color: #005CC5\">true</span></a><span style=\"color: #24292E\">});</span></li><li value=\"11\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/compute/#rsh_const\" title=\"rsh: const\"><span style=\"color: #D73A49\">const</span></a><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">x</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">;</span></li><li value=\"12\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/compute/#rsh_const\" title=\"rsh: const\"><span style=\"color: #D73A49\">const</span></a><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">y</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><a href=\"/rsh/compute/#rsh_true\" title=\"rsh: true\"><span style=\"color: #005CC5\">true</span></a><span style=\"color: #24292E\">;</span></li><li value=\"13\"><span style=\"color: #24292E\">  </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\">.interact.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">({x, y});</span></li><li value=\"14\"><span style=\"color: #24292E\">  </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\">.interact.</span><span style=\"color: #6F42C1\">log</span><span style=\"color: #24292E\">(</span><a href=\"/rsh/compute/#rsh_Maybe\" title=\"rsh: Maybe\"><span style=\"color: #6F42C1\">Maybe</span></a><span style=\"color: #24292E\">(UInt).</span><a href=\"/rsh/compute/#rsh_Some\" title=\"rsh: Some\"><span style=\"color: #6F42C1\">Some</span></a><span style=\"color: #24292E\">(</span><span style=\"color: #005CC5\">5</span><span style=\"color: #24292E\">));</span></li><li value=\"15\"><span style=\"color: #24292E\">  </span><a href=\"/rsh/step/#rsh_exit\" title=\"rsh: exit\"><span style=\"color: #6F42C1\">exit</span></a><span style=\"color: #24292E\">();</span></li><li value=\"16\"><span style=\"color: #24292E\">});</span></li></ol></pre>\n<p><i id=\"p_6\" class=\"pid\"></i>Then, a JavaScript frontend can simply use <span class=\"snip\"><span style=\"color: #24292E\">console.log</span></span> as the value of the <code>log</code> function.<a href=\"#p_6\" class=\"pid\">6</a></p>\n<p>\n  <i id=\"p_7\" class=\"pid\"></i>Reach provides <span class=\"snip\"><a href=\"/rsh/compute/#rsh_hasConsoleLogger\" title=\"rsh: hasConsoleLogger\"><span style=\"color: #24292E\">hasConsoleLogger</span></a></span> and hasConsoleLogger (Frontend) in the standard library\n  for default implementations of logging to stdout. It can be used in Reach with:<a href=\"#p_7\" class=\"pid\">7</a>\n</p>\n<pre class=\"snippet unnumbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"const A = Participant('Alice', { ...hasConsoleLogger })\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/compute/#rsh_const\" title=\"rsh: const\"><span style=\"color: #D73A49\">const</span></a><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">A</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><a href=\"/rsh/appinit/#rsh_Participant\" title=\"rsh: Participant\"><span style=\"color: #6F42C1\">Participant</span></a><span style=\"color: #24292E\">(</span><span style=\"color: #032F62\">'Alice'</span><span style=\"color: #24292E\">, { </span><span style=\"color: #D73A49\">...</span><span style=\"color: #24292E\">hasConsoleLogger })</span></li></ol></pre>\n<p><i id=\"p_8\" class=\"pid\"></i>and in the JavaScript frontend with:<a href=\"#p_8\" class=\"pid\">8</a></p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"backend.Alice(\n   ctcAlice,\n   { ...stdlib.hasConsoleLogger },\n ),\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><span style=\"color: #24292E\">backend.</span><span style=\"color: #6F42C1\">Alice</span><span style=\"color: #24292E\">(</span></li><li value=\"2\"><span style=\"color: #24292E\">   ctcAlice,</span></li><li value=\"3\"><span style=\"color: #24292E\">   { </span><span style=\"color: #D73A49\">...</span><span style=\"color: #24292E\">stdlib.hasConsoleLogger },</span></li><li value=\"4\"><span style=\"color: #24292E\"> ),</span></li></ol></pre>\n<p><i id=\"p_9\" class=\"pid\"></i>The Reach development repository contains an example of this pattern: <a href=\"https://github.com/reach-sh/reach-lang/tree/master/examples/log/index.rsh\">log/index.rsh</a> and <a href=\"https://github.com/reach-sh/reach-lang/tree/master/examples/log/index.mjs\">log/index.mjs</a>.<a href=\"#p_9\" class=\"pid\">9</a></p>","<ul><li class=\"dynamic\"><a href=\"#guide-logging\">How do I add tracing logs to my Reach program?</a></li></ul>"]