[{"bookPath":"","title":"Local Steps","titleId":"ref-programs-local","hasOtp":true,"hasPageHeader":true},"<p>\n  <i id=\"p_0\" class=\"pid\"></i>A Reach local step occurs in the body of <span class=\"snip\"><a href=\"/rsh/step/#rsh_only\" title=\"rsh: only\"><span style=\"color: var(--shiki-color-text)\">only</span></a></span> or <span class=\"snip\"><a href=\"/rsh/step/#rsh_each\" title=\"rsh: each\"><span style=\"color: var(--shiki-color-text)\">each</span></a></span> statements.\n  It represents the actions taken by a single participant in an application.<a href=\"#p_0\" class=\"pid\">0</a>\n</p>\n<h2 id=\"ref-programs-local-stmts\" class=\"refHeader\">Statements<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#ref-programs-local-stmts\"><span class=\"icon icon-link\"></span></a></h2>\n<p><i id=\"p_1\" class=\"pid\"></i>Any statements valid for a <a href=\"/rsh/compute/#ref-programs-compute-stmts\">computation</a> are valid for a local step.<a href=\"#p_1\" class=\"pid\">1</a></p>\n<h2 id=\"ref-programs-local-exprs\" class=\"refHeader\">Expressions<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#ref-programs-local-exprs\"><span class=\"icon icon-link\"></span></a></h2>\n<p>\n  <i id=\"p_2\" class=\"pid\"></i>Any expressions valid for a <a href=\"/rsh/compute/#ref-programs-compute-exprs\">computation</a> are valid for a local step.\n  However, some additional expressions are allowed.<a href=\"#p_2\" class=\"pid\">2</a>\n</p>\n<h3 id=\"ref-programs-local-this\" class=\"refHeader\"><code>this</code><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#ref-programs-local-this\"><span class=\"icon icon-link\"></span></a></h3>\n<p>\n  <i id=\"p_3\" class=\"pid\"></i>Inside of a local step, <span class=\"snip\"><a href=\"/rsh/compute/#rsh_this\" title=\"rsh: this\"><span style=\"color: var(--shiki-token-constant)\">this</span></a></span> refers to the participant performing the step.\n  This is useful when the local step was initiated by an <span class=\"snip\"><a href=\"/rsh/step/#rsh_each\" title=\"rsh: each\"><span style=\"color: var(--shiki-color-text)\">each</span></a></span> expression.<a href=\"#p_3\" class=\"pid\">3</a>\n</p>\n<h3 id=\"interact\" class=\"refHeader\"><code>interact</code><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#interact\"><span class=\"icon icon-link\"></span></a></h3>\n<p><span class=\"ref\" id=\"rsh_interact\" data-scope=\"rsh\" data-symbol=\"interact\"></span></p>\n<pre class=\"snippet numbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"interact.amount\ninteract.notify(handA, handB)\ninteract.chooseAmount(heap1, heap2)\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/local/#rsh_interact\" title=\"rsh: interact\"><span style=\"color: var(--shiki-token-constant)\">interact</span></a><span style=\"color: var(--shiki-color-text)\">.amount</span></li><li value=\"2\"><a href=\"/rsh/local/#rsh_interact\" title=\"rsh: interact\"><span style=\"color: var(--shiki-token-constant)\">interact</span></a><span style=\"color: var(--shiki-token-function)\">.notify</span><span style=\"color: var(--shiki-color-text)\">(handA</span><span style=\"color: var(--shiki-token-punctuation)\">,</span><span style=\"color: var(--shiki-color-text)\"> handB)</span></li><li value=\"3\"><a href=\"/rsh/local/#rsh_interact\" title=\"rsh: interact\"><span style=\"color: var(--shiki-token-constant)\">interact</span></a><span style=\"color: var(--shiki-token-function)\">.chooseAmount</span><span style=\"color: var(--shiki-color-text)\">(heap1</span><span style=\"color: var(--shiki-token-punctuation)\">,</span><span style=\"color: var(--shiki-color-text)\"> heap2)</span></li></ol></pre>\n<p><i id=\"p_4\" class=\"pid\"></i>An <span class=\"term\" id=\"term_interaction%20expression\">interaction expression</span>, written <span class=\"snip\"><a href=\"/rsh/local/#rsh_interact\" title=\"rsh: interact\"><span style=\"color: var(--shiki-token-constant)\">interact</span></a><span style=\"color: var(--shiki-token-function)\">.METHOD</span><span style=\"color: var(--shiki-color-text)\">(</span><span style=\"color: var(--shiki-token-constant)\">EXPR_0</span><span style=\"color: var(--shiki-token-punctuation)\">,</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-keyword)\">...</span><span style=\"color: var(--shiki-token-punctuation)\">,</span><span style=\"color: var(--shiki-color-text)\"> EXPR_n)</span></span>, where <span class=\"snip\"><span style=\"color: var(--shiki-token-constant)\">METHOD</span></span> is an identifier bound in the participant interact interface to a function type, and <span class=\"snip\"><span style=\"color: var(--shiki-token-constant)\">EXPR_0</span></span> through <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">EXPR_n</span></span> are expressions that evaluate to the result of an interaction with a frontend that receives the evaluation of the <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">n</span></span> expressions and sends a value.<a href=\"#p_4\" class=\"pid\">4</a></p>\n<p><i id=\"p_5\" class=\"pid\"></i>An interaction expression may also be written <span class=\"snip\"><a href=\"/rsh/local/#rsh_interact\" title=\"rsh: interact\"><span style=\"color: var(--shiki-token-constant)\">interact</span></a><span style=\"color: var(--shiki-color-text)\">.</span><span style=\"color: var(--shiki-token-constant)\">KEY</span></span>, where <span class=\"snip\"><span style=\"color: var(--shiki-token-constant)\">KEY</span></span> is bound in the participant interact interface to a non-function type.<a href=\"#p_5\" class=\"pid\">5</a></p>\n<p><i id=\"p_6\" class=\"pid\"></i>An interaction expression may only occur in a local step.<a href=\"#p_6\" class=\"pid\">6</a></p>\n<h3 id=\"assume\" class=\"refHeader\"><code>assume</code><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#assume\"><span class=\"icon icon-link\"></span></a></h3>\n<p><span class=\"ref\" id=\"rsh_assume\" data-scope=\"rsh\" data-symbol=\"assume\"></span></p>\n<pre class=\"snippet unnumbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"assume( claim, [msg] )\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/local/#rsh_assume\" title=\"rsh: assume\"><span style=\"color: var(--shiki-token-function)\">assume</span></a><span style=\"color: var(--shiki-color-text)\">( claim</span><span style=\"color: var(--shiki-token-punctuation)\">,</span><span style=\"color: var(--shiki-color-text)\"> [msg] )</span></li></ol></pre>\n<p>\n  <i id=\"p_7\" class=\"pid\"></i>An assumption where <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">claim</span></span> evaluates to <span class=\"snip\"><a href=\"/rsh/compute/#rsh_true\" title=\"rsh: true\"><span style=\"color: var(--shiki-token-constant)\">true</span></a></span> with honest frontends.\n  This may only appear in a local step.\n  It accepts an optional bytes argument, which is included in any reported violation.<a href=\"#p_7\" class=\"pid\">7</a>\n</p>\n<p><i id=\"p_8\" class=\"pid\"></i>If the claim dynamically evaluates to <code>false</code>, the frontend will raise an exception.<a href=\"#p_8\" class=\"pid\">8</a></p>\n<h3 id=\"fail\" class=\"refHeader\"><code>fail</code><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#fail\"><span class=\"icon icon-link\"></span></a></h3>\n<p><span class=\"ref\" id=\"rsh_fail\" data-scope=\"rsh\" data-symbol=\"fail\"></span></p>\n<pre class=\"snippet unnumbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"fail()\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/local/#rsh_fail\" title=\"rsh: fail\"><span style=\"color: var(--shiki-token-function)\">fail</span></a><span style=\"color: var(--shiki-color-text)\">()</span></li></ol></pre>\n<p><i id=\"p_9\" class=\"pid\"></i>is a convenience method equivalent to <span class=\"snip\"><a href=\"/rsh/local/#rsh_assume\" title=\"rsh: assume\"><span style=\"color: var(--shiki-token-function)\">assume</span></a><span style=\"color: var(--shiki-color-text)\">(</span><a href=\"/rsh/compute/#rsh_false\" title=\"rsh: false\"><span style=\"color: var(--shiki-token-constant)\">false</span></a><span style=\"color: var(--shiki-color-text)\">)</span></span>. This may only appear in a local step.<a href=\"#p_9\" class=\"pid\">9</a></p>\n<h3 id=\"declassify\" class=\"refHeader\"><code>declassify</code><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#declassify\"><span class=\"icon icon-link\"></span></a></h3>\n<p><span class=\"ref\" id=\"rsh_declassify\" data-scope=\"rsh\" data-symbol=\"declassify\"></span></p>\n<pre class=\"snippet unnumbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"declassify( arg )\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/local/#rsh_declassify\" title=\"rsh: declassify\"><span style=\"color: var(--shiki-token-function)\">declassify</span></a><span style=\"color: var(--shiki-color-text)\">( arg )</span></li></ol></pre>\n<p><i id=\"p_10\" class=\"pid\"></i>The <span class=\"term\" id=\"term_declassify\">declassify</span> primitive performs a declassification of the given argument.<a href=\"#p_10\" class=\"pid\">10</a></p>\n<h3 id=\"makecommitment\" class=\"refHeader\"><code>makeCommitment</code><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#makecommitment\"><span class=\"icon icon-link\"></span></a></h3>\n<p><span class=\"ref\" id=\"rsh_makeCommitment\" data-scope=\"rsh\" data-symbol=\"makeCommitment\"></span></p>\n<pre class=\"snippet unnumbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"makeCommitment( interact, x )\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/local/#rsh_makeCommitment\" title=\"rsh: makeCommitment\"><span style=\"color: var(--shiki-token-function)\">makeCommitment</span></a><span style=\"color: var(--shiki-color-text)\">( interact</span><span style=\"color: var(--shiki-token-punctuation)\">,</span><span style=\"color: var(--shiki-color-text)\"> x )</span></li></ol></pre>\n<p>\n  <i id=\"p_11\" class=\"pid\"></i>Returns two values, <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">[ commitment</span><span style=\"color: var(--shiki-token-punctuation)\">,</span><span style=\"color: var(--shiki-color-text)\"> salt ]</span></span>, where <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">salt</span></span> is the result of calling <span class=\"snip\"><a href=\"/rsh/local/#rsh_interact\" title=\"rsh: interact\"><span style=\"color: var(--shiki-token-constant)\">interact</span></a><span style=\"color: var(--shiki-token-function)\">.random</span><span style=\"color: var(--shiki-color-text)\">()</span></span>, and\n  <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">commitment</span></span> is the digest of <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">salt</span></span> and <span class=\"snip\"><span style=\"color: var(--shiki-color-text)\">x</span></span>.\n  This is used in a local step before <span class=\"snip\"><a href=\"/rsh/consensus/#rsh_checkCommitment\" title=\"rsh: checkCommitment\"><span style=\"color: var(--shiki-color-text)\">checkCommitment</span></a></span> is used in a consensus step.<a href=\"#p_11\" class=\"pid\">11</a>\n</p>\n<h3 id=\"didpublish\" class=\"refHeader\"><code>didPublish</code><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#didpublish\"><span class=\"icon icon-link\"></span></a></h3>\n<p><span class=\"ref\" id=\"rsh_didPublish\" data-scope=\"rsh\" data-symbol=\"didPublish\"></span></p>\n<pre class=\"snippet unnumbered\"><div class=\"codeHeader\">&nbsp;<a class=\"far fa-copy copyBtn\" data-clipboard-text=\"didPublish()\" href=\"#\"></a></div><ol class=\"snippet\"><li value=\"1\"><a href=\"/rsh/local/#rsh_didPublish\" title=\"rsh: didPublish\"><span style=\"color: var(--shiki-token-function)\">didPublish</span></a><span style=\"color: var(--shiki-color-text)\">()</span></li></ol></pre>\n<p><i id=\"p_12\" class=\"pid\"></i>Returns a boolean that indicates whether the last publication was made by this principal.<a href=\"#p_12\" class=\"pid\">12</a></p>","<ul><li class=\"dynamic\">\n    <a href=\"#ref-programs-local\">Local Steps</a>\n    <ul class=\"dynamic\">\n      <li class=\"dynamic\">\n        <a href=\"#ref-programs-local-stmts\">Statements</a>\n      </li>\n      <li class=\"dynamic\">\n        <a href=\"#ref-programs-local-exprs\">Expressions</a>\n        <ul class=\"dynamic\">\n          <li class=\"dynamic\"><a href=\"#ref-programs-local-this\"><code>this</code></a></li>\n          <li class=\"dynamic\"><a href=\"#interact\"><code>interact</code></a></li>\n          <li class=\"dynamic\"><a href=\"#assume\"><code>assume</code></a></li>\n          <li class=\"dynamic\"><a href=\"#fail\"><code>fail</code></a></li>\n          <li class=\"dynamic\"><a href=\"#declassify\"><code>declassify</code></a></li>\n          <li class=\"dynamic\"><a href=\"#makecommitment\"><code>makeCommitment</code></a></li>\n          <li class=\"dynamic\"><a href=\"#didpublish\"><code>didPublish</code></a></li>\n        </ul>\n      </li>\n    </ul>\n  </li></ul>"]